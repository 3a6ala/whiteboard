//A function that can make any div editable (double click on it and
//it will replace the content with an editable field, and then go
//back when you're done).
function makeEditable(e,t,n,r){var i;t.text=t.innerHTML;var s=function(e){e.keyCode==13&&o()},o=function(e){i.removeEventListener("blur",o,!1);i.removeEventListener("keydown",s,!1);t.text=i.value;t.innerHTML=t.text;t.editing=!1;r(t.editing);t.text==""&&n()},u=function(n){if(t.editing||!e.editable)return;t.editing=!0;r(t.editing);t.innerHTML="<textarea></textarea>";i=t.childNodes[0];i.value=t.text;i.focus();i.addEventListener("blur",o,!1);i.addEventListener("keydown",s,!1)};t.addEventListener("dblclick",u,!1);return function(){t.removeEventListener("dblclick",u,!1)}}function makeDraggable(e,t){e.dragging=!1;e.dragStart;e.dragMouseStart;e.draggable=!0;e.size=new point(0,0);var n=function(t){if(!e.draggable)return;e.dragging=!0;e.dragStart=new point(e.pos.x,e.pos.y);e.dragMouseStart=new point(e.canvas.mouseX,e.canvas.mouseY)},r=function(t){if(!e.dragging)return;var n=new point;n.x=e.dragStart.x+(e.canvas.mouseX-e.dragMouseStart.x);n.y=e.dragStart.y+(e.canvas.mouseY-e.dragMouseStart.y);n.x<0&&(n.x=0);n.y<0&&(n.y=0);n.x>e.canvas.canvasWidth-e.size.x&&(n.x=e.canvas.canvasWidth-e.size.x);n.y>e.canvas.canvasHeight-e.size.y&&(n.y=e.canvas.canvasHeight-e.size.y);e.setPos(n.x,n.y);e.id!=null&&NetworkManager.itemMoved(e.id,n.x,n.y)},i=function(t){if(e.dragging){e.dragging=!1;e.canvas.sizeToContent();e.id!=null&&NetworkManager.sizeToContent(e.id)}};t.addEventListener("mousedown",n,!0);window.addEventListener("mousemove",r,!1);window.addEventListener("mouseup",i,!1);return function(){t.removeEventListener("mousedown",n,!0);window.removeEventListener("mousemove",r,!1);window.removeEventListener("mouseup",i,!1)}};